\include{common}

\begin{document}

\begin{multicols*}{3}

\begin{center}
	\LARGE{\textbf{Git Cheat Sheet}}\\
	\large{\reflectbox{\textcopyright} Erik E. Lorenz, \today}
\end{center}


\section{Help}
\mytable{gX}{
	\code{git help}	&	show commonly used commands	\\
	\code{git help -a}	&	show all commands	\\
	\code{git} \textit{command} \code{--help}	&	show help for a specific command	\\
}

\section{Internal Files and Directories}
\mytable{gX}{
	\code{$\sim$/.gitconfig}	&	global git configuration. See \texttt{git config --global}	\\
	\code{./.git/}	&	internal git data	\\
	\code{./.git/config}	&	local git configuration		\\
	\code{.gitignore}	&	list of patterns and relative paths to ignore in \repo{}\\
}

\section{Terms}
\mytable{gXg}{
	\thead{term}	&	\thead{description}	&	\thead{examples}	\\
	\repo{}	&	project dir. Contains \code{.git/} &	$\sim$/code/project	\\
	\commit{}	&	set of changes relative to previous commit	&	c03aa34b...\\
	\branch{}	&	reference to a commit. Automatically updated by \code{git commit}	&	\sct{master\\devel\\remote{}s/origin/master}	\\
	\file{}	&	regular file within \repo{}	&	\sct{README\\src/main.cpp}	\\
	\dir{}	&	regular subdirectory of \repo{}	&	src/	\\
	\tag{}	&	fixed reference to a commit	&	v1.0	\\
	\remote{}	&	alias for a remote url	&	\sct{origin\\github}	\\
	\url{}	&	address of a remote git repository. Can be read-only (http) or read-write	&	\sct{http://github.com/usr/proj\\gitolite@sim:project\\/mnt/tmp/project.git}	\\
%	\rbranch{}	&	reference to remote branch	&	\code{remote/\textit{remote}/\branch{}}	\\
}
\mytable{gX} {
	\code{HEAD}	&	reference to current \commit{}	\\
	\code{HEAD\^{}}	&	reference to last \commit{}		\\
	unstaged file	&	a file which hasn't been added to the next commit	\\
	staged file	&	a file which has been added to the next commit	\\
	tracked file	&	a file which has been previously committed	\\
	untracked file	&	a file which hasn't been tracked during the last commit	\\
	new file	&	a previously untracked file	\\
	ignored file	&	a file which won't be tracked or staged. see \code{.gitignore}	\\
}

\section{Cheat Sheet Color Coding}
\mytable{gX}{
	\code{cmd}	&	Usually not harmful. Changes local references only.	\\
	\attention{\code{cmd}}	&	Rewrites history, permanently deletes data or annoys others	\\
}

\section{Global Setup}
\mytable{gX}{
	\specialcell{\code{git config --global user.name "}\textit{Your Name}\code{"}	\\
	\code{git config --global user.email "}\textit{your@mail.com}\code{"}}
		&	user settings	\\
	\code{git config --global color.ui true}	&	terminal colors	\\
}
\\
\vspace{1em}
Bonus: add the \code{git graph} alias:
\\
\mytable{G}{
\code{git config --global alias.graph "log --graph --all --format=format:'\%C(bold blue)\%h\%C(reset) - \%C(bold green)(\%ar)\%C(reset) \%C(white)\%s\%C(reset) \%C(bold white)-- \%an\%C(reset)\%C(bold yellow)\%d\%C(reset)' --abbrev-commit --date=relative"}	\\
}

\section{Repository Initialization}
\mytable{gX}{
	\code{git init} \dir	&	create \dir{} as a git repository	\\
	\code{git init}	&	convert the current directory to a git repository	\\
	\code{git clone} \url{}	&	clone a remote repository into a new directory	\\
	\myopt{--bare}	&	\myoptd{without working copy}	\\
	\myopt{--depth} \textit{num}	&	\myoptd{shallow clone: omits older commits}	\\
}

\section{Workflow Examples}
\mytable{gX}{
	\sct{
		\code{cd} \dir{}\\
		\code{git init}\\
		\code{git add .}\\
		\code{git commit -m 'initial commit'}\\
	}	&	
	creation of a new repository
	\\\hline
	\sct{
		\code{git checkout -b feature-}\textit{asd}\\
		(file editing)\\
		\code{git add .}\\
		\code{git commit -m 'feature }\textit{asd} \code{implemented'}\\
	}	&
	usual workflow when writing new features or fixing bugs
	\\\hline
	\sct{
		\code{git checkout master}\\
		\code{git merge --no-ff feature-}\textit{asd}\\
		\code{git branch -d feature-}\textit{asd}\\
		\code{git push origin master}\\
	}	&
	updating the master branch after a feature has been successfully implemented.
	\\
}

\section{Managing Local Changes}
\mytable{gX}{
	\code{git status}	&	show staged, unstaged and new files	\\
	\code{git status} \dir{}\textbar\file{}	&	show status of a subset of files	\\
	\code{git diff}	&	show all changed lines since last commit	\\
	\code{git diff} \file{}	&	show \code{diff} for \file{} only	\\
	\code{git diff} \file{} \commit{}	&	show changes since \commit{}	\\
	\code{git add} \dir{}\textbar\file{}	&	stage \dir{} or \file{} for the next commit	\\
	\code{git add -u}	&	stage all tracked files	\\
	\code{git add --all}	&	stage all existing files, including new files	\\
	\code{git add -A}	&	alias for \code{git add --all}	\\
	\code{git stage}	&	alias for \code{git add}	\\
	\code{git rm} \file{}	&	delete \file{} and stage its deletion	\\
	\code{git mv} \textit{file... \textit{target}}	&	move and stage one or more files	\\
	\code{git commit}	&	bundle staged changes int a new \commit{}	\\
	\myopt{-m '}\textit{commit message}\myoptc{'}	&	\myoptd{pass the commit message in-line}	\\
	\attention{\myopt{--amend}}	&	\myoptd{add changes to last commit}	\\
}

\section{Managing Local Branches}
\mytable{gX}{
	\code{git branch}	&	show current branch	\\
	\code{git branch -a}	&	show all branches	\\
	\code{git checkout} \branch{}	&	reset files to \branch{}	\\
	\code{git branch} \branch{}	&	create a new branch at the current commit	\\
	\code{git checkout -b} \branch{}	&	create a new branch and check it out	\\
	\code{git merge} \branch{}	&	merge changes from another branch	\\
	\myopt{--no-ff}	&	force a new commit (cleaner merge history)	\\
	\myopt{--ff-only}	&	don't merge if both branches were changed	\\
	\code{git branch -d} \branch{}	&	delete a merged local branch	\\
	\attention{\code{git branch -D}	\branch{}}	&	force deletion of a local branch	\\
}

\section{Stashes}
\mytable{gX}{
	\code{git stash save}	&	save all changes in a stash and reset to last commit	\\
	\code{git stash list}	&	list all stashes	\\
	\code{git stash show}	&	show which files were changed	\\
	\code{git stash pop}	&	remove and apply stash (e.g. to a different branch)	\\
}

\section{Remote Repositories}
\mytable{gX}{
	\code{git clone} \url{}	&	creates the remote \code{origin} during \code{init}	\\
	\code{git remote -v}	&	show all remotes and addresses	\\
	\code{git remote add} \remote{} \url{}	&	create a new remote	\\
	\code{git remote rm} \remote{}	&	delete a remote	\\
	\code{git fetch} \remote{}	&	fetch all branches without merging	\\
	\code{git fetch --all}	&	fetch from all remotes without merging	\\
	\code{git pull} \remote{} \branch{}	&	\code{fetch} and \code{merge} a remote branch	\\
	\myopt{--ff-only}	&	\myoptd{Only merge if there's no file conflict}	\\
	\code{git push} \remote{} \branch{}	&	upload local commits to \remote{}	\\
	\attention{\code{git push} \remote{} \code{:}\branch{}}	&	delete \branch{} on \remote{}	\\
	\code{git remote prune} \remote{}	&	delete invalid refs to remote branches \\
}

\section{Upstreams}

%%%%%%% DIRTY HACK AHEAD %%%%%%%
\vspace{0.81ex}
%%%%%%% DIRTY HACK END %%%%%%%

\mytable{gX}{
	\code{git push -u} \remote{} \branch{}	&	set upstream and push to \remote{} \branch{}	\\
	\code{git pull}	&	pull current branch from upstream	\\
	\code{git push}	&	push current branch to upstream	\\
	\code{git push --all}	&	push all branches to their upstream	\\
	\multicolumn{2}{|g|}{\code{git branch --set-upstream-to=}\remote{}\code{/}\branch{}}\\
		&	set upstream of the current branch	\\
}

\section{Managing Tags}
\mytable{gX}{
	\code{git tag -a }\tag{} \commit{}\textbar\branch{}	&	create a tag at \commit{} or \branch{}	\\
	\myopt{-m '}\textit{tag message}\code{'}	&	\myoptd{pass the tag message in-line}	\\
	\code{git tag -d }\tag{}	&	delete \tag{} locally	\\
	\code{git push --tags}	&	push all tags	\\
	\code{git push} \remote{} \code{:refs/tags/}\tag{}	&	delete a remote tag	\\
}

\section{Searching for Files}
\mytable{gX}{
	\code{git grep '}\textit{pattern}\code{'}	&	search all tracked files for \textit{pattern}	\\
	\code{git ls-files}	&	list tracked files	\\
	\myopt{-d}	&	\myoptd{list deleted files}	\\
	\myopt{-m}	&	\myoptd{list modified files}	\\
	\myopt{-u}	&	\myoptd{on merge conflict, list unmerged files}	\\
	\myopt{--other --exclude-standard}	&	\myoptd{list untracked files} \\
	\code{git clean -ndx}	&	list untracked and ignored files	\\
	\code{git clean -ndX}	&	list ignored files	\\
}

\section{Working Directory Cleanup}
\mytable{gX}{
	\code{git clean -f}	&	delete untracked files	\\
	\code{git clean -fd}	&	delete untracked files and directories	\\
	\code{git clean -fdX}	&	delete ignored files only	\\
	\code{git clean -fdx}	&	delete untracked and ignored files	\\
	\multicolumn{2}{|g|}{\code{git archive --prefix=}\textit{project}\code{/ -o }\textit{project}\code{.tar.gz} \branch{}}	\\
	&	create a tar.gz archive of all tracked files	\\
}

\section{Commit History}
\mytable{gX}{
	\code{git log}	&	show local commit history	\\
	\code{git graph}	&	pseudo-graphical commit history. See \textbf{Setup}	\\
	\code{git ls-tree -r HEAD}	&	show modification commit for each file	\\
	\code{git show \commit{}}	&	\code{diff} of the given \commit{} to its parent	\\
	\code{git blame} \file{}	&	show the modification commit for each line \\
}

\section{Undo Bad Things \texttrademark}
\mytable{gX}{
	\attention{\code{git reset HEAD \file{}}}	&	undo \code{git add} of a single file	\\
	\attention{\code{git reset --hard}}	&	undo everything since last commit	\\
	\attention{\code{git checkout --} \file{}}	&	undo \file{} changes since last commit	\\
	\attention{\sct{\code{git rebase} \\ \myopt{--onto} \branch{} \commit{}}}	&	undo \code{git branch} by moving commits on top of the old branch	\\
	\attention{\code{git push} \remote{} \commit{}:\branch{}}	&	revert remote branch to \commit{}	\\
	\attention{\code{rm -rfv} \repo{}\code{/.git*}}	&	undo \code{git init}	\\
}
\\
\vspace{1em}
Accidentally committed a password file? Delete any copy or reference of it on the current branch:
\mytable{a}{
	\code{git filter-branch --force --index-filter 'git rm --cached}
	\\
	\code{--ignore-unmatch} \file{} \code{' --prune-empty --tag-name-filter cat -- --all}
	\\
}



\section{Further Reading}

\begin{tabularx}{0.33\textwidth}{X}
\textbf{A successful Git branching model}\\
http://nvie.com/posts/a-successful-git-branching-model/
\\
\textbf{AlBlue's Git Tip of the Week}\\
http://alblue.bandlem.com/Tag/gtotw/
\\
\textbf{git Documentation}\\
http://git-scm.com/doc
\end{tabularx}

\end{multicols*}

\end{document}
